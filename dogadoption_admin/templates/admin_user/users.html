{% extends "admin_base.html" %}
{% load static %}
{%  block extra_css %}
<link rel="stylesheet" href="{% static 'css/admin_users.css' %}">
{% endblock extra_css %}
{% block content %}

<h1 class="mb-4">Registered Users (Profile + Face Auth)</h1>

{% if users %}
<table>
    <thead>
        <tr>
            <th>User Info</th>
            <th>Profile</th>
            <th>Face Auth Images</th>
            <th>Joined</th>
        </tr>
    </thead>
    <tbody>

    {% for user in users %}
        <tr>
            <!-- USER INFO -->
            <td>
                <strong>{{ user.username }}</strong><br>
                {{ user.first_name }} {{ user.last_name }}
            </td>

            <!-- PROFILE -->
            <td>
                {% if user.profile.profile_image %}
                    <img src="{{ user.profile.profile_image.url }}"
                         class="profile-img"
                         width="60" height="60">
                {% endif %}
                <br>
                <small>
                    MI: {{ user.profile.middle_initial|default:"—" }}<br>
                    Age: {{ user.profile.age|default:"—" }}<br>
                    {{ user.profile.address|default:"—" }}
                </small>
            </td>

            <!-- FACE AUTH IMAGES -->
            <td>
                {% if user.faceimage_set.all %}
                    {% for face in user.faceimage_set.all %}
                        <img src="{{ face.image.url }}" alt="Face Image">
                    {% endfor %}
                {% else %}
                    <small>No face images</small>
                {% endif %}
            </td>

            <!-- CREATED -->
            <td>
                {{ user.date_joined|date:"M d, Y" }}
            </td>
        </tr>
    {% endfor %}

    </tbody>
</table>
{% else %}
<p>No users found.</p>
{% endif %}

{% endblock %}
